{"remainingRequest":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\ts-loader\\index.js??ref--14-3!C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\src\\js\\States.ts","dependencies":[{"path":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\src\\js\\States.ts","mtime":1632856214376},{"path":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9pbmhlcml0cyBmcm9tICJDOi9Vc2Vycy9naW8vRGVza3RvcC93b3JrL2xpdmVuZXNzL2xpdmVuZXNzLWRldGVjdGlvbi9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICJDOi9Vc2Vycy9naW8vRGVza3RvcC93b3JrL2xpdmVuZXNzL2xpdmVuZXNzLWRldGVjdGlvbi9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9naW8vRGVza3RvcC93b3JrL2xpdmVuZXNzL2xpdmVuZXNzLWRldGVjdGlvbi9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOi9Vc2Vycy9naW8vRGVza3RvcC93b3JrL2xpdmVuZXNzL2xpdmVuZXNzLWRldGVjdGlvbi9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKLy8gQ29weXJpZ2h0IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVQtMAppbXBvcnQgTG9nZ2VyIGZyb20gImpzLWxvZ2dlciI7CmltcG9ydCB7IERyYXdlciB9IGZyb20gIkAvanMvRHJhd2VyLnRzIjsKaW1wb3J0IHsgVXRpbHMgfSBmcm9tICJAL2pzL1V0aWxzLnRzIjsKZXhwb3J0IHZhciBTdGF0ZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gU3RhdGUoY2hhbGxlbmdlRGV0YWlscykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0YXRlKTsKCiAgICB0aGlzLmNoYWxsZW5nZURldGFpbHMgPSBjaGFsbGVuZ2VEZXRhaWxzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFN0YXRlLCBbewogICAga2V5OiAicHJvY2VzcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvY2VzcyggLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lCiAgICBfZmFjZXMpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfQogIH0sIHsKICAgIGtleTogImdldE1heGltdW1EdXJhdGlvbkluU2Vjb25kcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWF4aW11bUR1cmF0aW9uSW5TZWNvbmRzKCkgewogICAgICByZXR1cm4gLTE7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNGYWNlQm94SW5zaWRlRmFjZUFyZWEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzRmFjZUJveEluc2lkZUZhY2VBcmVhKGZhY2VCb3gpIHsKICAgICAgdmFyIGFkZFRvbGVyYW5jZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdHJ1ZTsKICAgICAgdmFyIHRvbGVyYW5jZSA9IGFkZFRvbGVyYW5jZSA/IHBhcnNlSW50KFV0aWxzLmdldENvbmZpZygpLkZBQ0VfQVJFQV9UT0xFUkFOQ0VfUEVSQ0VOVCkgLyAxMDAgOiAwOwogICAgICByZXR1cm4gZmFjZUJveC54ID49IHRoaXMuY2hhbGxlbmdlRGV0YWlscy5hcmVhTGVmdCAqICgxIC0gdG9sZXJhbmNlKSAmJiBmYWNlQm94LnkgPj0gdGhpcy5jaGFsbGVuZ2VEZXRhaWxzLmFyZWFUb3AgKiAoMSAtIHRvbGVyYW5jZSkgJiYgZmFjZUJveC54ICsgZmFjZUJveC53aWR0aCA8PSB0aGlzLmNoYWxsZW5nZURldGFpbHMuYXJlYUxlZnQgKyB0aGlzLmNoYWxsZW5nZURldGFpbHMuYXJlYVdpZHRoICogKDEgKyB0b2xlcmFuY2UpICYmIGZhY2VCb3gueSArIGZhY2VCb3guaGVpZ2h0IDw9IHRoaXMuY2hhbGxlbmdlRGV0YWlscy5hcmVhVG9wICsgdGhpcy5jaGFsbGVuZ2VEZXRhaWxzLmFyZWFIZWlnaHQgKiAoMSArIHRvbGVyYW5jZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNOb3NlSW5zaWRlTm9zZUFyZWEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzTm9zZUluc2lkZU5vc2VBcmVhKG5vc2UpIHsKICAgICAgcmV0dXJuIG5vc2UueCA+PSB0aGlzLmNoYWxsZW5nZURldGFpbHMubm9zZUxlZnQgJiYgbm9zZS55ID49IHRoaXMuY2hhbGxlbmdlRGV0YWlscy5ub3NlVG9wICYmIG5vc2UueCA8PSB0aGlzLmNoYWxsZW5nZURldGFpbHMubm9zZUxlZnQgKyB0aGlzLmNoYWxsZW5nZURldGFpbHMubm9zZVdpZHRoICYmIG5vc2UueSA8PSB0aGlzLmNoYWxsZW5nZURldGFpbHMubm9zZVRvcCArIHRoaXMuY2hhbGxlbmdlRGV0YWlscy5ub3NlSGVpZ2h0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFN0YXRlOwp9KCk7CmV4cG9ydCB2YXIgRmFpbFN0YXRlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RhdGUpIHsKICBfaW5oZXJpdHMoRmFpbFN0YXRlLCBfU3RhdGUpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEZhaWxTdGF0ZSk7CgogIGZ1bmN0aW9uIEZhaWxTdGF0ZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGYWlsU3RhdGUpOwoKICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIF9jcmVhdGVDbGFzcyhGYWlsU3RhdGUsIFt7CiAgICBrZXk6ICJnZXROYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROYW1lKCkgewogICAgICByZXR1cm4gRmFpbFN0YXRlLk5BTUU7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRmFpbFN0YXRlOwp9KFN0YXRlKTsKRmFpbFN0YXRlLk5BTUUgPSAiRmFpbFN0YXRlIjsKZXhwb3J0IHZhciBTdWNjZXNzU3RhdGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGF0ZTIpIHsKICBfaW5oZXJpdHMoU3VjY2Vzc1N0YXRlLCBfU3RhdGUyKTsKCiAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoU3VjY2Vzc1N0YXRlKTsKCiAgZnVuY3Rpb24gU3VjY2Vzc1N0YXRlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN1Y2Nlc3NTdGF0ZSk7CgogICAgcmV0dXJuIF9zdXBlcjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIF9jcmVhdGVDbGFzcyhTdWNjZXNzU3RhdGUsIFt7CiAgICBrZXk6ICJnZXROYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROYW1lKCkgewogICAgICByZXR1cm4gU3VjY2Vzc1N0YXRlLk5BTUU7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3VjY2Vzc1N0YXRlOwp9KFN0YXRlKTsKU3VjY2Vzc1N0YXRlLk5BTUUgPSAiU3VjY2Vzc1N0YXRlIjsKZXhwb3J0IHZhciBOb3NlU3RhdGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGF0ZTMpIHsKICBfaW5oZXJpdHMoTm9zZVN0YXRlLCBfU3RhdGUzKTsKCiAgdmFyIF9zdXBlcjMgPSBfY3JlYXRlU3VwZXIoTm9zZVN0YXRlKTsKCiAgZnVuY3Rpb24gTm9zZVN0YXRlKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb3NlU3RhdGUpOwoKICAgIF90aGlzID0gX3N1cGVyMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgX3RoaXMuZnJhbWVzV2l0aG91dEZhY2UgPSAwOwogICAgX3RoaXMubGFuZG1hcmtJbmRleCA9IHBhcnNlSW50KFV0aWxzLmdldENvbmZpZygpLkxBTkRNQVJLX0lOREVYKTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhOb3NlU3RhdGUsIFt7CiAgICBrZXk6ICJwcm9jZXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzKGZhY2VzKSB7CiAgICAgIHZhciBuZXh0U3RhdGUgPSB0aGlzOwoKICAgICAgaWYgKGZhY2VzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIGlmICh0aGlzLmlzRmFjZUJveEluc2lkZUZhY2VBcmVhKGZhY2VzWzBdLmRldGVjdGlvbi5ib3gpKSB7CiAgICAgICAgICBpZiAodGhpcy5pc05vc2VJbnNpZGVOb3NlQXJlYShmYWNlc1swXS5sYW5kbWFya3MucG9zaXRpb25zW3RoaXMubGFuZG1hcmtJbmRleF0pKSB7CiAgICAgICAgICAgIG5leHRTdGF0ZSA9IG5ldyBTdWNjZXNzU3RhdGUodGhpcy5jaGFsbGVuZ2VEZXRhaWxzKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgTG9nZ2VyLmluZm8oIk5vc2VTdGF0ZSBmYWlsOiBpc0ZhY2VCb3hJbnNpZGVGYWNlQXJlYT0iLmNvbmNhdCh0aGlzLmlzRmFjZUJveEluc2lkZUZhY2VBcmVhKGZhY2VzWzBdLmRldGVjdGlvbi5ib3gpKSk7CiAgICAgICAgICBuZXh0U3RhdGUgPSBuZXcgRmFpbFN0YXRlKHRoaXMuY2hhbGxlbmdlRGV0YWlscyk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChmYWNlcy5sZW5ndGggIT09IDAgfHwgKyt0aGlzLmZyYW1lc1dpdGhvdXRGYWNlID4gcGFyc2VJbnQoVXRpbHMuZ2V0Q29uZmlnKCkuU1RBVEVfTk9TRV9NQVhfRlJBTUVTX1dJVEhPVVRfRkFDRSkpIHsKICAgICAgICAgIExvZ2dlci5pbmZvKCJOb3NlU3RhdGUgZmFpbDogI2ZhY2VzPSIuY29uY2F0KGZhY2VzLmxlbmd0aCwgIiBmcmFtZXNXaXRob3V0RmFjZT0iKS5jb25jYXQodGhpcy5mcmFtZXNXaXRob3V0RmFjZSkpOwogICAgICAgICAgbmV4dFN0YXRlID0gbmV3IEZhaWxTdGF0ZSh0aGlzLmNoYWxsZW5nZURldGFpbHMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBMb2dnZXIuZGVidWcoIm5vIGZhY2UgZGV0ZWN0ZWQuIFNraXBwaW5nIGZyYW1lLi4uIik7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZHJhd09wdGlvbnMgPSB7CiAgICAgICAgZmFjZURyYXdCb3hPcHRpb25zOiB7CiAgICAgICAgICBib3hDb2xvcjogRHJhd2VyLkNPTE9SX0dSRUVOCiAgICAgICAgfSwKICAgICAgICBub3NlRHJhd0JveE9wdGlvbnM6IHsKICAgICAgICAgIGJveENvbG9yOiBEcmF3ZXIuQ09MT1JfWUVMTE9XCiAgICAgICAgfQogICAgICB9OwogICAgICByZXR1cm4gewogICAgICAgIG5leHRTdGF0ZTogbmV4dFN0YXRlLAogICAgICAgIGRyYXdPcHRpb25zOiBkcmF3T3B0aW9ucywKICAgICAgICBoZWxwTWVzc2FnZTogIk1vdmUgdGhlIHRpcCBvZiB5b3VyIG5vc2UgaW5zaWRlIHRoZSB5ZWxsb3cgYXJlYSIsCiAgICAgICAgaGVscEFuaW1hdGlvbk51bWJlcjogMgogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImdldE1heGltdW1EdXJhdGlvbkluU2Vjb25kcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWF4aW11bUR1cmF0aW9uSW5TZWNvbmRzKCkgewogICAgICByZXR1cm4gcGFyc2VJbnQoVXRpbHMuZ2V0Q29uZmlnKCkuU1RBVEVfTk9TRV9EVVJBVElPTl9JTl9TRUNPTkRTKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXROYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROYW1lKCkgewogICAgICByZXR1cm4gTm9zZVN0YXRlLk5BTUU7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTm9zZVN0YXRlOwp9KFN0YXRlKTsKTm9zZVN0YXRlLk5BTUUgPSAiTm9zZVN0YXRlIjsKZXhwb3J0IHZhciBBcmVhU3RhdGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGF0ZTQpIHsKICBfaW5oZXJpdHMoQXJlYVN0YXRlLCBfU3RhdGU0KTsKCiAgdmFyIF9zdXBlcjQgPSBfY3JlYXRlU3VwZXIoQXJlYVN0YXRlKTsKCiAgZnVuY3Rpb24gQXJlYVN0YXRlKCkgewogICAgdmFyIF90aGlzMjsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXJlYVN0YXRlKTsKCiAgICBfdGhpczIgPSBfc3VwZXI0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICBfdGhpczIuZnJhbWVzV2l0aG91dEZhY2UgPSAwOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogIF9jcmVhdGVDbGFzcyhBcmVhU3RhdGUsIFt7CiAgICBrZXk6ICJwcm9jZXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzKGZhY2VzKSB7CiAgICAgIHZhciBuZXh0U3RhdGUgPSB0aGlzOwogICAgICB2YXIgYm94Q29sb3IgPSBEcmF3ZXIuQ09MT1JfUkVEOwoKICAgICAgaWYgKGZhY2VzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIGlmICh0aGlzLmlzRmFjZUJveEluc2lkZUZhY2VBcmVhKGZhY2VzWzBdLmRldGVjdGlvbi5ib3gsIGZhbHNlKSkgewogICAgICAgICAgYm94Q29sb3IgPSBEcmF3ZXIuQ09MT1JfR1JFRU47CiAgICAgICAgICBuZXh0U3RhdGUgPSBuZXcgTm9zZVN0YXRlKHRoaXMuY2hhbGxlbmdlRGV0YWlscyk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChmYWNlcy5sZW5ndGggIT09IDAgfHwgKyt0aGlzLmZyYW1lc1dpdGhvdXRGYWNlID4gcGFyc2VJbnQoVXRpbHMuZ2V0Q29uZmlnKCkuU1RBVEVfQVJFQV9NQVhfRlJBTUVTX1dJVEhPVVRfRkFDRSkpIHsKICAgICAgICAgIExvZ2dlci5pbmZvKCJBcmVhU3RhdGUgZmFpbDogI2ZhY2VzPSIuY29uY2F0KGZhY2VzLmxlbmd0aCwgIiBmcmFtZXNXaXRob3V0RmFjZT0iKS5jb25jYXQodGhpcy5mcmFtZXNXaXRob3V0RmFjZSkpOwogICAgICAgICAgbmV4dFN0YXRlID0gbmV3IEZhaWxTdGF0ZSh0aGlzLmNoYWxsZW5nZURldGFpbHMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBMb2dnZXIuZGVidWcoIm5vIGZhY2UgZGV0ZWN0ZWQuIFNraXBwaW5nIGZyYW1lLi4uIik7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZHJhd09wdGlvbnMgPSB7CiAgICAgICAgZmFjZURyYXdCb3hPcHRpb25zOiB7CiAgICAgICAgICBib3hDb2xvcjogYm94Q29sb3IKICAgICAgICB9CiAgICAgIH07CiAgICAgIHJldHVybiB7CiAgICAgICAgbmV4dFN0YXRlOiBuZXh0U3RhdGUsCiAgICAgICAgZHJhd09wdGlvbnM6IGRyYXdPcHRpb25zLAogICAgICAgIGhlbHBNZXNzYWdlOiAiQ2VudGVyIHlvdXIgZmFjZSBpbnNpZGUgdGhlIGFyZWEiLAogICAgICAgIGhlbHBBbmltYXRpb25OdW1iZXI6IDEKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRNYXhpbXVtRHVyYXRpb25JblNlY29uZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1heGltdW1EdXJhdGlvbkluU2Vjb25kcygpIHsKICAgICAgcmV0dXJuIHBhcnNlSW50KFV0aWxzLmdldENvbmZpZygpLlNUQVRFX0FSRUFfRFVSQVRJT05fSU5fU0VDT05EUyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmFtZSgpIHsKICAgICAgcmV0dXJuIEFyZWFTdGF0ZS5OQU1FOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFyZWFTdGF0ZTsKfShTdGF0ZSk7CkFyZWFTdGF0ZS5OQU1FID0gIkFyZWFTdGF0ZSI7CmV4cG9ydCB2YXIgRmFjZVN0YXRlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RhdGU1KSB7CiAgX2luaGVyaXRzKEZhY2VTdGF0ZSwgX1N0YXRlNSk7CgogIHZhciBfc3VwZXI1ID0gX2NyZWF0ZVN1cGVyKEZhY2VTdGF0ZSk7CgogIGZ1bmN0aW9uIEZhY2VTdGF0ZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGYWNlU3RhdGUpOwoKICAgIHJldHVybiBfc3VwZXI1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRmFjZVN0YXRlLCBbewogICAga2V5OiAicHJvY2VzcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvY2VzcyhmYWNlcykgewogICAgICB2YXIgbmV4dFN0YXRlID0gdGhpczsKICAgICAgdmFyIGhlbHBNZXNzYWdlID0gdW5kZWZpbmVkOwoKICAgICAgc3dpdGNoIChmYWNlcy5sZW5ndGgpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBoZWxwTWVzc2FnZSA9ICJObyBmYWNlIGRldGVjdGVkLiBMb29rIGF0IHRoZSBjYW1lcmEuIjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBuZXh0U3RhdGUgPSBuZXcgQXJlYVN0YXRlKHRoaXMuY2hhbGxlbmdlRGV0YWlscyk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGhlbHBNZXNzYWdlID0gIk1vcmUgdGhhbiBvbmUgZmFjZSBkZXRlY3RlZC4gU2hvdWxkIGJlIG9uZS4iOwogICAgICB9CgogICAgICB2YXIgZHJhd09wdGlvbnMgPSB7CiAgICAgICAgZmFjZURyYXdCb3hPcHRpb25zOiB7CiAgICAgICAgICBib3hDb2xvcjogRHJhd2VyLkNPTE9SX1JFRAogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIHsKICAgICAgICBuZXh0U3RhdGU6IG5leHRTdGF0ZSwKICAgICAgICBkcmF3T3B0aW9uczogZHJhd09wdGlvbnMsCiAgICAgICAgaGVscE1lc3NhZ2U6IGhlbHBNZXNzYWdlCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmFtZSgpIHsKICAgICAgcmV0dXJuIEZhY2VTdGF0ZS5OQU1FOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEZhY2VTdGF0ZTsKfShTdGF0ZSk7CkZhY2VTdGF0ZS5OQU1FID0gIkZhY2VTdGF0ZSI7"},{"version":3,"sources":["C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\gio\\Desktop\\work\\liveness\\liveness-detection\\client\\src\\js\\States.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n// SPDX-License-Identifier: MIT-0\r\n\r\nimport * as faceapi from \"face-api.js\";\r\nimport Logger from \"js-logger\";\r\nimport { ChallengeDetails } from \"@/js/RemoteStarter.ts\";\r\nimport { Drawer, DrawOptions } from \"@/js/Drawer.ts\";\r\nimport { Utils } from \"@/js/Utils.ts\";\r\n\r\nexport interface StateOutput {\r\n  readonly nextState?: State;\r\n  readonly drawOptions?: DrawOptions;\r\n  readonly helpMessage?: string;\r\n  readonly helpAnimationNumber?: number;\r\n}\r\n\r\nexport abstract class State {\r\n  constructor(readonly challengeDetails: ChallengeDetails) {}\r\n\r\n  process(\r\n    // eslint-disable-next-line\r\n    _faces: faceapi.WithFaceLandmarks<{ detection: faceapi.FaceDetection }, faceapi.FaceLandmarks68>[]\r\n  ): StateOutput {\r\n    return {};\r\n  }\r\n\r\n  getMaximumDurationInSeconds(): number {\r\n    return -1;\r\n  }\r\n\r\n  protected isFaceBoxInsideFaceArea(faceBox: faceapi.Box, addTolerance = true) {\r\n    const tolerance: number = addTolerance ? parseInt(Utils.getConfig().FACE_AREA_TOLERANCE_PERCENT) / 100 : 0;\r\n    return (\r\n      faceBox.x >= this.challengeDetails.areaLeft * (1 - tolerance) &&\r\n      faceBox.y >= this.challengeDetails.areaTop * (1 - tolerance) &&\r\n      faceBox.x + faceBox.width <= this.challengeDetails.areaLeft + this.challengeDetails.areaWidth * (1 + tolerance) &&\r\n      faceBox.y + faceBox.height <= this.challengeDetails.areaTop + this.challengeDetails.areaHeight * (1 + tolerance)\r\n    );\r\n  }\r\n\r\n  protected isNoseInsideNoseArea(nose: faceapi.IPoint) {\r\n    return (\r\n      nose.x >= this.challengeDetails.noseLeft &&\r\n      nose.y >= this.challengeDetails.noseTop &&\r\n      nose.x <= this.challengeDetails.noseLeft + this.challengeDetails.noseWidth &&\r\n      nose.y <= this.challengeDetails.noseTop + this.challengeDetails.noseHeight\r\n    );\r\n  }\r\n\r\n  abstract getName(): string;\r\n}\r\n\r\nexport class FailState extends State {\r\n  static NAME = \"FailState\";\r\n\r\n  getName(): string {\r\n    return FailState.NAME;\r\n  }\r\n}\r\n\r\nexport class SuccessState extends State {\r\n  static NAME = \"SuccessState\";\r\n\r\n  getName(): string {\r\n    return SuccessState.NAME;\r\n  }\r\n}\r\n\r\nexport class NoseState extends State {\r\n  static NAME = \"NoseState\";\r\n\r\n  private framesWithoutFace = 0;\r\n  private landmarkIndex = parseInt(Utils.getConfig().LANDMARK_INDEX);\r\n\r\n  process(\r\n    faces: faceapi.WithFaceLandmarks<{ detection: faceapi.FaceDetection }, faceapi.FaceLandmarks68>[]\r\n  ): StateOutput {\r\n    let nextState: State = this;\r\n    if (faces.length === 1) {\r\n      if (this.isFaceBoxInsideFaceArea(faces[0].detection.box)) {\r\n        if (this.isNoseInsideNoseArea(faces[0].landmarks.positions[this.landmarkIndex])) {\r\n          nextState = new SuccessState(this.challengeDetails);\r\n        }\r\n      } else {\r\n        Logger.info(`NoseState fail: isFaceBoxInsideFaceArea=${this.isFaceBoxInsideFaceArea(faces[0].detection.box)}`);\r\n        nextState = new FailState(this.challengeDetails);\r\n      }\r\n    } else {\r\n      if (\r\n        faces.length !== 0 ||\r\n        ++this.framesWithoutFace > parseInt(Utils.getConfig().STATE_NOSE_MAX_FRAMES_WITHOUT_FACE)\r\n      ) {\r\n        Logger.info(`NoseState fail: #faces=${faces.length} framesWithoutFace=${this.framesWithoutFace}`);\r\n        nextState = new FailState(this.challengeDetails);\r\n      } else {\r\n        Logger.debug(`no face detected. Skipping frame...`);\r\n      }\r\n    }\r\n    const drawOptions: DrawOptions = {\r\n      faceDrawBoxOptions: {\r\n        boxColor: Drawer.COLOR_GREEN\r\n      },\r\n      noseDrawBoxOptions: {\r\n        boxColor: Drawer.COLOR_YELLOW\r\n      }\r\n    };\r\n    return {\r\n      nextState: nextState,\r\n      drawOptions: drawOptions,\r\n      helpMessage: \"Move the tip of your nose inside the yellow area\",\r\n      helpAnimationNumber: 2\r\n    };\r\n  }\r\n\r\n  getMaximumDurationInSeconds(): number {\r\n    return parseInt(Utils.getConfig().STATE_NOSE_DURATION_IN_SECONDS);\r\n  }\r\n\r\n  getName(): string {\r\n    return NoseState.NAME;\r\n  }\r\n}\r\n\r\nexport class AreaState extends State {\r\n  static NAME = \"AreaState\";\r\n\r\n  private framesWithoutFace = 0;\r\n\r\n  process(\r\n    faces: faceapi.WithFaceLandmarks<{ detection: faceapi.FaceDetection }, faceapi.FaceLandmarks68>[]\r\n  ): StateOutput {\r\n    let nextState: State = this;\r\n    let boxColor = Drawer.COLOR_RED;\r\n    if (faces.length === 1) {\r\n      if (this.isFaceBoxInsideFaceArea(faces[0].detection.box, false)) {\r\n        boxColor = Drawer.COLOR_GREEN;\r\n        nextState = new NoseState(this.challengeDetails);\r\n      }\r\n    } else {\r\n      if (\r\n        faces.length !== 0 ||\r\n        ++this.framesWithoutFace > parseInt(Utils.getConfig().STATE_AREA_MAX_FRAMES_WITHOUT_FACE)\r\n      ) {\r\n        Logger.info(`AreaState fail: #faces=${faces.length} framesWithoutFace=${this.framesWithoutFace}`);\r\n        nextState = new FailState(this.challengeDetails);\r\n      } else {\r\n        Logger.debug(`no face detected. Skipping frame...`);\r\n      }\r\n    }\r\n    const drawOptions: DrawOptions = {\r\n      faceDrawBoxOptions: {\r\n        boxColor: boxColor\r\n      }\r\n    };\r\n    return {\r\n      nextState: nextState,\r\n      drawOptions: drawOptions,\r\n      helpMessage: \"Center your face inside the area\",\r\n      helpAnimationNumber: 1\r\n    };\r\n  }\r\n\r\n  getMaximumDurationInSeconds(): number {\r\n    return parseInt(Utils.getConfig().STATE_AREA_DURATION_IN_SECONDS);\r\n  }\r\n\r\n  getName(): string {\r\n    return AreaState.NAME;\r\n  }\r\n}\r\n\r\nexport class FaceState extends State {\r\n  static NAME = \"FaceState\";\r\n\r\n  process(\r\n    faces: faceapi.WithFaceLandmarks<{ detection: faceapi.FaceDetection }, faceapi.FaceLandmarks68>[]\r\n  ): StateOutput {\r\n    let nextState: State = this;\r\n    let helpMessage = undefined;\r\n    switch (faces.length) {\r\n      case 0:\r\n        helpMessage = \"No face detected. Look at the camera.\";\r\n        break;\r\n      case 1:\r\n        nextState = new AreaState(this.challengeDetails);\r\n        break;\r\n      default:\r\n        helpMessage = \"More than one face detected. Should be one.\";\r\n    }\r\n    const drawOptions: DrawOptions = {\r\n      faceDrawBoxOptions: {\r\n        boxColor: Drawer.COLOR_RED\r\n      }\r\n    };\r\n    return {\r\n      nextState: nextState,\r\n      drawOptions: drawOptions,\r\n      helpMessage: helpMessage\r\n    };\r\n  }\r\n\r\n  getName(): string {\r\n    return FaceState.NAME;\r\n  }\r\n}\r\n"],"sourceRoot":""}]}